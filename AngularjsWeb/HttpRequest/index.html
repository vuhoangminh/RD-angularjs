<!doctype html>
<html>
	<head>
		<title>Http Request</title>

		<!-- LOAD BOOTSTRAP CSS -->
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">

		<!-- LOAD JQUERY -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
		<!-- LOAD ANGULAR -->
		<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>

		<!-- PROCESS FORM WITH AJAX (NEW) -->
		<script>

			// define angular module/app
			var formApp = angular.module('formApp', []);

			// create angular controller and pass in $scope and $http
			function formController($scope, $http) {

				// create a blank object to hold our form information
				// $scope will allow this to pass between controller and view
				$scope.formData = {};

				// process the form
				$scope.processForm = function() {
					$http({
						  

						method  : 'POST'
						url     : 'http://192.168.1.14:8080/smartdatics-sora/restapi/room/',
						data    : $.param($scope.formData),  
						headers : { 'Content-Type': 'application/x-www-form-urlencoded' } 		
						<!-- data    : $.param($scope.formData), -->  // pass in data as strings
						<!-- headers : { 'Content-Type': 'application/x-www-form-urlencoded' }  -->
						// set the headers so angular passing info as form data (not request payload)
					})
						.success(function(data) {
							console.log(data);

							if (!data.success) {
								// if not successful, bind errors to error variables
								$scope.errorName = data.errors.name;
								$scope.errorSuperhero = data.errors.superheroAlias;
							} else {
								// if successful, bind success message to message
								$scope.message = data.message;
											$scope.errorName = '';
								$scope.errorSuperhero = '';
							}
						});

				};

			}
		</script>
		<style>
			.ng-valid.ng-dirty{
				border-color: green;
			}
			.ng-invalid.ng-dirty{
				border-color: red;
			}
		</style>
	</head>
	<!-- apply the module and controller to our body so angular is applied to that -->
	<body ng-app="formApp" ng-controller="formController">
		<div class="container">
		<div class="col-md-6 col-md-offset-3">

			<!-- PAGE TITLE -->
			<div class="page-header">
				<h2 style="text-align: center;">SORA | Submitting Forms</h2>
			</div>

			<!-- SHOW ERROR/SUCCESS MESSAGES -->
			<div id="messages" class="well" ng-show="message">{{ message }}</div>

			<!-- FORM -->
			<form ng-submit="processForm()">
				<!-- METHOD -->
				<div class="form-group">
					<label for="method">Method</label>
					<select class="form-control selectpicker" name="method" ng-model="formData.method">
					  <option value="" selected disabled>Please select</option>
					  <option value="POST">POST</option>
					  <option value="GET">GET</option>
					  <option value="PUT">PUT</option>
					  <option value="DELETE">DELETE</option>
					</select>
				</div>  

				<!-- URL -->
				<div class="form-group">
					<label for="url">Url</label>
					<input type="text" class="form-control" name="url" ng-model="formData.url" 
							placeholder="'http://192.168.1.14:8080/smartdatics-sora/restapi/room/'">
				</div>

				<!-- DATA -->
				<div class="form-group">
					<label for="data">Json data</label>
					<textarea type="text" class="form-control" name="data" ng-model="formData.data"
						   placeholder="Place your full json data here" rows="4" ></textarea>
				</div>

				<!-- SUBMIT BUTTON -->
				<button type="submit" class="btn btn-success btn-lg btn-block">
					<span class="glyphicon glyphicon-flash"></span> Submit
				</button>
			</form>

			<!-- SHOW DATA FROM INPUTS AS THEY ARE BEING TYPED -->
			<pre>
				{{ formData }}
			</pre>
			
			<pre>
				{{ formDataInput }}
			</pre>

		</div>
		</div>
	</body>
</html>
